<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quản lý Sản phẩm - Nhà Thuốc Online</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary-color: #2c8c4d;
            --primary-dark: #1e6e3d;
            --secondary-color: #3498db;
            --accent-color: #e74c3c;
            --light-color: #f8f9fa;
            --dark-color: #2c3e50;
            --sidebar-width: 250px;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background: #f5f6fa;
            display: flex;
            min-height: 100vh;
        }

        /* Sidebar */
        .sidebar {
            width: var(--sidebar-width);
            background: var(--dark-color);
            color: white;
            position: fixed;
            height: 100vh;
            transition: all 0.3s ease;
            z-index: 1000;
        }

        .sidebar-header {
            padding: 20px;
            background: var(--primary-color);
            text-align: center;
        }

        .sidebar-header h2 {
            font-size: 18px;
            margin-bottom: 5px;
        }

        .sidebar-header p {
            font-size: 12px;
            opacity: 0.8;
        }

        .sidebar-menu {
            padding: 20px 0;
        }

        .menu-item {
            padding: 12px 20px;
            display: flex;
            align-items: center;
            gap: 12px;
            color: #ddd;
            text-decoration: none;
            transition: all 0.3s ease;
            border-left: 3px solid transparent;
        }

        .menu-item:hover, .menu-item.active {
            background: rgba(255,255,255,0.1);
            color: white;
            border-left-color: var(--primary-color);
        }

        .menu-item i {
            width: 20px;
            text-align: center;
        }

        /* Main Content */
        .main-content {
            flex: 1;
            margin-left: var(--sidebar-width);
            padding: 20px;
        }

        .header {
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            margin-bottom: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .user-info {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .user-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: var(--primary-color);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
        }

        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 500;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        .btn-primary {
            background: var(--primary-color);
            color: white;
        }

        .btn-primary:hover {
            background: var(--primary-dark);
            transform: translateY(-2px);
        }

        .btn-success {
            background: #28a745;
            color: white;
        }

        .btn-warning {
            background: #ffc107;
            color: #212529;
        }

        .btn-logout {
            background: var(--accent-color);
            color: white;
        }

        .btn-logout:hover {
            background: #c0392b;
        }

        /* Advanced Search */
        .advanced-search {
            background: white;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            padding: 20px;
            margin-bottom: 20px;
            display: none;
        }

        .search-header {
            display: flex;
            justify-content: between;
            align-items: center;
            margin-bottom: 15px;
        }

        .search-row {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 15px;
        }

        .form-group {
            margin-bottom: 15px;
        }

        .form-group label {
            display: block;
            margin-bottom: 5px;
            color: var(--dark-color);
            font-weight: 500;
            font-size: 14px;
        }

        .form-control {
            width: 100%;
            padding: 10px 15px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 14px;
            transition: all 0.3s ease;
        }

        .form-control:focus {
            border-color: var(--primary-color);
            outline: none;
            box-shadow: 0 0 0 3px rgba(44, 140, 77, 0.1);
        }

        /* Products Table */
        .products-table {
            background: white;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .table-header {
            padding: 20px;
            border-bottom: 1px solid #eee;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 15px;
        }

        .search-box {
            display: flex;
            gap: 10px;
            flex: 1;
            min-width: 300px;
        }

        .search-box input {
            padding: 10px 15px;
            border: 1px solid #ddd;
            border-radius: 5px;
            flex: 1;
            min-width: 200px;
        }

        .table-actions {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .batch-actions {
            display: flex;
            gap: 10px;
            align-items: center;
            margin-right: 15px;
        }

        .table-container {
            overflow-x: auto;
            max-height: 600px;
            overflow-y: auto;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            min-width: 800px;
        }

        th, td {
            padding: 15px;
            text-align: left;
            border-bottom: 1px solid #eee;
        }

        th {
            background: #f8f9fa;
            font-weight: 600;
            color: var(--dark-color);
            position: sticky;
            top: 0;
            z-index: 10;
        }

        .product-image {
            width: 50px;
            height: 50px;
            border-radius: 5px;
            object-fit: cover;
            border: 1px solid #eee;
        }

        .status {
            padding: 5px 10px;
            border-radius: 15px;
            font-size: 12px;
            font-weight: 500;
            display: inline-block;
        }

        .status.active {
            background: #e8f5e9;
            color: var(--primary-color);
        }

        .status.inactive {
            background: #ffebee;
            color: var(--accent-color);
        }

        .status.low-stock {
            background: #fff3cd;
            color: #856404;
        }

        .stock-indicator {
            width: 60px;
            height: 6px;
            background: #e9ecef;
            border-radius: 3px;
            overflow: hidden;
            margin-top: 5px;
        }

        .stock-fill {
            height: 100%;
            border-radius: 3px;
            transition: width 0.3s ease;
        }

        .stock-high { background: var(--primary-color); width: 80%; }
        .stock-medium { background: #ffc107; width: 50%; }
        .stock-low { background: var(--accent-color); width: 20%; }

        .btn-action {
            padding: 6px 12px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            margin: 0 2px;
            font-size: 12px;
            display: inline-flex;
            align-items: center;
            gap: 4px;
            transition: all 0.3s ease;
        }

        .btn-action:hover {
            transform: translateY(-1px);
        }

        .btn-edit {
            background: var(--secondary-color);
            color: white;
        }

        .btn-delete {
            background: var(--accent-color);
            color: white;
        }

        .btn-view {
            background: #6c757d;
            color: white;
        }

        .pagination {
            padding: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-top: 1px solid #eee;
            flex-wrap: wrap;
            gap: 15px;
        }

        .pagination-info {
            color: #666;
            font-size: 14px;
        }

        .pagination-controls {
            display: flex;
            gap: 5px;
            align-items: center;
        }

        .page-btn {
            padding: 8px 12px;
            border: 1px solid #ddd;
            background: white;
            cursor: pointer;
            border-radius: 3px;
            transition: all 0.3s ease;
        }

        .page-btn:hover {
            background: #f8f9fa;
        }

        .page-btn.active {
            background: var(--primary-color);
            color: white;
            border-color: var(--primary-color);
        }

        .page-info {
            margin: 0 10px;
            color: #666;
            font-size: 14px;
        }

        /* Checkbox */
        .checkbox-cell {
            width: 40px;
            text-align: center;
        }

        .select-checkbox {
            width: 18px;
            height: 18px;
            cursor: pointer;
        }

        /* Quick View Modal */
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.5);
        }

        .modal-content {
            background-color: white;
            margin: 5% auto;
            padding: 0;
            border-radius: 10px;
            width: 90%;
            max-width: 600px;
            max-height: 80vh;
            overflow-y: auto;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        }

        .modal-header {
            padding: 20px;
            border-bottom: 1px solid #eee;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .modal-body {
            padding: 20px;
        }

        .close {
            color: #aaa;
            font-size: 24px;
            font-weight: bold;
            cursor: pointer;
            background: none;
            border: none;
        }

        .close:hover {
            color: #000;
        }

        @media (max-width: 768px) {
            .sidebar {
                width: 70px;
            }
            .sidebar-header h2, .sidebar-header p, .menu-item span {
                display: none;
            }
            .main-content {
                margin-left: 70px;
            }
            .table-header {
                flex-direction: column;
                align-items: stretch;
            }
            .search-box {
                min-width: auto;
            }
            .table-actions {
                justify-content: space-between;
            }
            .batch-actions {
                margin-right: 0;
            }
        }
    </style>
</head>
<body>
    <!-- Sidebar -->
    <div class="sidebar">
        <div class="sidebar-header">
            <h2>NHÀ THUỐC ONLINE</h2>
            <p>Hệ thống quản trị</p>
        </div>
        
        <div class="sidebar-menu">
            <a href="./dashboard.html" class="menu-item">
                <i class="fas fa-tachometer-alt"></i>
                <span>Dashboard</span>
            </a>
            <a href="./products.html" class="menu-item active">
                <i class="fas fa-pills"></i>
                <span>Sản phẩm</span>
            </a>
            <a href="./categories.html" class="menu-item">
                <i class="fas fa-tags"></i>
                <span>Danh mục</span>
            </a>
            <a href="./orders.html" class="menu-item">
                <i class="fas fa-shopping-cart"></i>
                <span>Đơn hàng</span>
            </a>
            <a href="./customers.html" class="menu-item">
                <i class="fas fa-users"></i>
                <span>Khách hàng</span>
            </a>
            <a href="./import-products.html" class="menu-item">
                <i class="fas fa-upload"></i>
                <span>Nhập hàng</span>
            </a>
            <a href="./stock.html" class="menu-item">
                <i class="fas fa-boxes"></i>
                <span>Tồn kho</span>
            </a>
            <a href="./prices.html" class="menu-item">
                <i class="fas fa-tag"></i>
                <span>Giá bán</span>
            </a>
        </div>
    </div>

    <!-- Main Content -->
    <div class="main-content">
        <div class="header">
            <h1>Quản lý Sản phẩm</h1>
            <div class="user-info">
                <div class="user-avatar">A</div>
                <span>Xin chào, Admin</span>
                <button class="btn btn-logout" onclick="logout()">
                    <i class="fas fa-sign-out-alt"></i> Đăng xuất
                </button>
            </div>
        </div>

        <!-- Advanced Search -->
        <div class="advanced-search" id="advancedSearch">
            <div class="search-header">
                <h3>Tìm kiếm nâng cao</h3>
                <button class="btn" onclick="toggleAdvancedSearch()">
                    <i class="fas fa-times"></i> Đóng
                </button>
            </div>
            <div class="search-row">
                <div class="form-group">
                    <label>Danh mục</label>
                    <select class="form-control" id="searchCategory">
                        <option value="">Tất cả danh mục</option>
                        <option value="tpc">Thực phẩm chức năng</option>
                        <option value="medical">Vật phẩm y tế</option>
                        <option value="prescription">Thuốc kê đơn</option>
                        <option value="otc">Thuốc không kê đơn</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Trạng thái</label>
                    <select class="form-control" id="searchStatus">
                        <option value="">Tất cả trạng thái</option>
                        <option value="active">Đang bán</option>
                        <option value="inactive">Ngừng bán</option>
                        <option value="low-stock">Sắp hết hàng</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Khoảng giá</label>
                    <select class="form-control" id="searchPriceRange">
                        <option value="">Tất cả mức giá</option>
                        <option value="0-50000">Dưới 50,000đ</option>
                        <option value="50000-200000">50,000đ - 200,000đ</option>
                        <option value="200000-500000">200,000đ - 500,000đ</option>
                        <option value="500000-1000000">500,000đ - 1,000,000đ</option>
                        <option value="1000000-9999999">Trên 1,000,000đ</option>
                    </select>
                </div>
            </div>
            <div class="search-row">
                <div class="form-group">
                    <label>Từ khóa</label>
                    <input type="text" class="form-control" id="searchKeyword" placeholder="Tên sản phẩm, mã SKU...">
                </div>
                <div class="form-group">
                    <label>Ngày tạo từ</label>
                    <input type="date" class="form-control" id="searchDateFrom">
                </div>
                <div class="form-group">
                    <label>Đến ngày</label>
                    <input type="date" class="form-control" id="searchDateTo">
                </div>
            </div>
            <div style="display: flex; gap: 10px;">
                <button class="btn btn-primary" onclick="performAdvancedSearch()">
                    <i class="fas fa-search"></i> Tìm kiếm
                </button>
                <button class="btn" onclick="resetAdvancedSearch()">
                    <i class="fas fa-redo"></i> Đặt lại
                </button>
            </div>
        </div>

        <!-- Products Table -->
        <div class="products-table">
            <div class="table-header">
                <h2>Danh sách sản phẩm <span id="productCount" style="color: #666; font-size: 14px;">(124 sản phẩm)</span></h2>
                <div class="table-actions">
                    <div class="batch-actions" id="batchActions" style="display: none;">
                        <span id="selectedCount">0 sản phẩm được chọn</span>
                        <button class="btn btn-warning" onclick="batchUpdateStatus('active')">
                            <i class="fas fa-play"></i> Kích hoạt
                        </button>
                        <button class="btn" onclick="batchUpdateStatus('inactive')">
                            <i class="fas fa-pause"></i> Tạm dừng
                        </button>
                        <button class="btn btn-danger" onclick="batchDeleteProducts()">
                            <i class="fas fa-trash"></i> Xóa
                        </button>
                    </div>
                    <div class="search-box">
                        <input type="text" id="searchInput" placeholder="Tìm kiếm sản phẩm..." onkeyup="performSearch()">
                        <button class="btn" onclick="toggleAdvancedSearch()">
                            <i class="fas fa-filter"></i> Lọc
                        </button>
                    </div>
                    <button class="btn btn-primary" onclick="showAddProductModal()">
                        <i class="fas fa-plus"></i> Thêm sản phẩm
                    </button>
                </div>
            </div>

            <div class="table-container">
                <table>
                    <thead>
                        <tr>
                            <th class="checkbox-cell">
                                <input type="checkbox" id="selectAll" class="select-checkbox" onchange="toggleSelectAll()">
                            </th>
                            <th>Hình ảnh</th>
                            <th onclick="sortTable('name')" style="cursor: pointer;">
                                Tên sản phẩm <i class="fas fa-sort"></i>
                            </th>
                            <th>Danh mục</th>
                            <th onclick="sortTable('price')" style="cursor: pointer;">
                                Giá <i class="fas fa-sort"></i>
                            </th>
                            <th>Tồn kho</th>
                            <th>Trạng thái</th>
                            <th>Thao tác</th>
                        </tr>
                    </thead>
                    <tbody id="productsTableBody">
                        <!-- Products will be loaded dynamically -->
                    </tbody>
                </table>
            </div>

            <div class="pagination">
                <div class="pagination-info">
                    Hiển thị <span id="displayRange">1-10</span> của <span id="totalProducts">124</span> sản phẩm
                </div>
                <div class="pagination-controls">
                    <button class="page-btn" onclick="changePage('prev')">‹</button>
                    <span class="page-info">Trang <span id="currentPage">1</span> / <span id="totalPages">13</span></span>
                    <button class="page-btn" onclick="changePage('next')">›</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Quick View Modal -->
    <div id="productModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Chi tiết sản phẩm</h3>
                <button class="close">&times;</button>
            </div>
            <div class="modal-body">
                <div id="modalContent">
                    <!-- Modal content will be loaded here -->
                </div>
            </div>
        </div>
    </div>

    <script>
        // Kiểm tra đăng nhập
        if (localStorage.getItem('adminLoggedIn') !== 'true') {
            window.location.href = './admin-login.html';
        }

        let products = [];
        let currentPage = 1;
        const itemsPerPage = 10;
        let sortField = 'name';
        let sortDirection = 'asc';

        function logout() {
            localStorage.removeItem('adminLoggedIn');
            localStorage.removeItem('adminUsername');
            window.location.href = './admin-login.html';
        }

        // Cập nhật thông tin người dùng
        document.addEventListener('DOMContentLoaded', function() {
            const username = localStorage.getItem('adminUsername') || 'Admin';
            document.querySelector('.user-avatar').textContent = username.charAt(0).toUpperCase();
            document.querySelector('.user-info span').textContent = `Xin chào, ${username}`;
            
            // Khởi tạo dữ liệu
            initializeProducts();
            renderProducts();
            
            // Đóng modal khi click outside
            const modal = document.getElementById('productModal');
            const closeBtn = document.querySelector('.close');
            
            closeBtn.onclick = function() {
                modal.style.display = 'none';
            }
            
            window.onclick = function(event) {
                if (event.target == modal) {
                    modal.style.display = 'none';
                }
            }
        });

        function initializeProducts() {
            // Dữ liệu mẫu
            products = [
                {
                    id: 1,
                    name: 'Vitamin C 1000mg',
                    category: 'Thực phẩm chức năng',
                    price: 150000,
                    stock: 45,
                    status: 'active',
                    image: 'https://tse2.mm.bing.net/th/id/OIP.VHQ2vXlMe-DHnx-ImU9QDQHaHa?cb=12&rs=1&pid=ImgDetMain&o=7&rm=3',
                    sku: 'VC1000',
                    created: '2023-01-15'
                },
                {
                    id: 2,
                    name: 'Máy đo huyết áp Omron',
                    category: 'Vật phẩm y tế',
                    price: 450000,
                    stock: 23,
                    status: 'active',
                    image: 'https://cdn11.dienmaycholon.vn/filewebdmclnew/public/userupload/files/mtsp/gia-dung/may-do-huyet-ap-tu-dong-omron-hem-7143t1-co-kieu-dang-nho-gon.jpg',
                    sku: 'OMRON-HBP',
                    created: '2023-02-20'
                },
                {
                    id: 3,
                    name: 'Panadol Extra',
                    category: 'Thuốc không kê đơn',
                    price: 80000,
                    stock: 0,
                    status: 'inactive',
                    image: 'https://abclive1.s3.amazonaws.com/2c2edf5e-aa5c-4940-b5c6-6eb1ac32a016/productimage/5099627630375___XL.jpg',
                    sku: 'PEXTRA',
                    created: '2023-03-10'
                },
                {
                    id: 4,
                    name: 'Canxi & Vitamin D3',
                    category: 'Thực phẩm chức năng',
                    price: 120000,
                    stock: 67,
                    status: 'active',
                    image: 'https://product.hstatic.net/1000251766/product/vien-uong-bo-sung-vitamin-d-canxi-ostelin-300v-1_e8a05c7b1d884866970c226e120f5b45_master.jpg',
                    sku: 'CA-D3',
                    created: '2023-04-05'
                },
                {
                    id: 5,
                    name: 'Thuốc ho Prospan',
                    category: 'Thuốc không kê đơn',
                    price: 95000,
                    stock: 3,
                    status: 'low-stock',
                    image: 'https://cdn.nhathuoclongchau.com.vn/unsafe/https://cms-prod.s3-sgn09.fptcloud.com/00006137_prospan_100ml_9655_5c68_large_ad5603e714.jpg',
                    sku: 'PROSPAN',
                    created: '2023-05-12'
                }
            ];
        }

        function renderProducts() {
            const tbody = document.getElementById('productsTableBody');
            const startIndex = (currentPage - 1) * itemsPerPage;
            const endIndex = startIndex + itemsPerPage;
            const displayedProducts = products.slice(startIndex, endIndex);

            tbody.innerHTML = '';

            displayedProducts.forEach(product => {
                const stockClass = product.stock > 20 ? 'stock-high' : 
                                 product.stock > 5 ? 'stock-medium' : 'stock-low';
                const stockWidth = product.stock > 100 ? 100 : product.stock;

                const row = document.createElement('tr');
                row.innerHTML = `
                    <td class="checkbox-cell">
                        <input type="checkbox" class="select-checkbox product-checkbox" data-id="${product.id}" onchange="updateSelection()">
                    </td>
                    <td>
                        <img src="${product.image}" alt="${product.name}" class="product-image">
                    </td>
                    <td>
                        <div style="font-weight: 500;">${product.name}</div>
                        <div style="font-size: 12px; color: #666;">SKU: ${product.sku}</div>
                    </td>
                    <td>${product.category}</td>
                    <td>${formatPrice(product.price)}</td>
                    <td>
                        <div>${product.stock}</div>
                        <div class="stock-indicator">
                            <div class="stock-fill ${stockClass}" style="width: ${stockWidth}%"></div>
                        </div>
                    </td>
                    <td>
                        <span class="status ${product.status}">
                            ${getStatusText(product.status)}
                        </span>
                    </td>
                    <td>
                        <button class="btn-action btn-view" onclick="viewProduct(${product.id})">
                            <i class="fas fa-eye"></i> Xem
                        </button>
                        <button class="btn-action btn-edit" onclick="editProduct(${product.id})">
                            <i class="fas fa-edit"></i> Sửa
                        </button>
                        <button class="btn-action btn-delete" onclick="deleteProduct(${product.id})">
                            <i class="fas fa-trash"></i> Xóa
                        </button>
                    </td>
                `;
                tbody.appendChild(row);
            });

            updatePaginationInfo();
        }

        function formatPrice(price) {
            return new Intl.NumberFormat('vi-VN', { 
                style: 'currency', 
                currency: 'VND' 
            }).format(price);
        }

        function getStatusText(status) {
            const statusMap = {
                'active': 'Đang bán',
                'inactive': 'Ngừng bán',
                'low-stock': 'Sắp hết'
            };
            return statusMap[status] || status;
        }

        function updatePaginationInfo() {
            document.getElementById('totalProducts').textContent = products.length;
            document.getElementById('currentPage').textContent = currentPage;
            document.getElementById('totalPages').textContent = Math.ceil(products.length / itemsPerPage);
            
            const start = (currentPage - 1) * itemsPerPage + 1;
            const end = Math.min(currentPage * itemsPerPage, products.length);
            document.getElementById('displayRange').textContent = `${start}-${end}`;
        }

        function changePage(direction) {
            const totalPages = Math.ceil(products.length / itemsPerPage);
            
            if (direction === 'prev' && currentPage > 1) {
                currentPage--;
            } else if (direction === 'next' && currentPage < totalPages) {
                currentPage++;
            }
            
            renderProducts();
        }

        function toggleAdvancedSearch() {
            const searchPanel = document.getElementById('advancedSearch');
            searchPanel.style.display = searchPanel.style.display === 'none' ? 'block' : 'none';
        }

        function performSearch() {
            const searchTerm = document.getElementById('searchInput').value.toLowerCase();
            // Filter logic would be implemented here
            renderProducts();
        }

        function performAdvancedSearch() {
            // Advanced search logic would be implemented here
            alert('Tìm kiếm nâng cao đang được thực hiện...');
        }

        function resetAdvancedSearch() {
            document.getElementById('advancedSearch').querySelectorAll('input, select').forEach(element => {
                if (element.type !== 'button') {
                    element.value = '';
                }
            });
        }

        function toggleSelectAll() {
            const selectAll = document.getElementById('selectAll');
            const checkboxes = document.querySelectorAll('.product-checkbox');
            
            checkboxes.forEach(checkbox => {
                checkbox.checked = selectAll.checked;
            });
            
            updateSelection();
        }

        function updateSelection() {
            const selectedCount = document.querySelectorAll('.product-checkbox:checked').length;
            document.getElementById('selectedCount').textContent = `${selectedCount} sản phẩm được chọn`;
            
            const batchActions = document.getElementById('batchActions');
            batchActions.style.display = selectedCount > 0 ? 'flex' : 'none';
        }

        function batchUpdateStatus(status) {
            const selectedIds = Array.from(document.querySelectorAll('.product-checkbox:checked'))
                .map(checkbox => parseInt(checkbox.dataset.id));
            
            if (selectedIds.length === 0) {
                alert('Vui lòng chọn ít nhất một sản phẩm!');
                return;
            }
            
            if (confirm(`Bạn có chắc muốn cập nhật trạng thái của ${selectedIds.length} sản phẩm?`)) {
                // Update logic would be implemented here
                alert(`Đã cập nhật trạng thái của ${selectedIds.length} sản phẩm`);
                renderProducts();
            }
        }

        function batchDeleteProducts() {
            const selectedIds = Array.from(document.querySelectorAll('.product-checkbox:checked'))
                .map(checkbox => parseInt(checkbox.dataset.id));
            
            if (selectedIds.length === 0) {
                alert('Vui lòng chọn ít nhất một sản phẩm!');
                return;
            }
            
            if (confirm(`Bạn có chắc muốn xóa ${selectedIds.length} sản phẩm? Hành động này không thể hoàn tác!`)) {
                // Delete logic would be implemented here
                alert(`Đã xóa ${selectedIds.length} sản phẩm`);
                renderProducts();
            }
        }

        function viewProduct(id) {
            const product = products.find(p => p.id === id);
            if (product) {
                document.getElementById('modalContent').innerHTML = `
                    <div style="display: grid; grid-template-columns: 1fr 2fr; gap: 20px; margin-bottom: 20px;">
                        <div>
                            <img src="${product.image}" alt="${product.name}" style="width: 100%; border-radius: 8px;">
                        </div>
                        <div>
                            <h4>${product.name}</h4>
                            <p><strong>SKU:</strong> ${product.sku}</p>
                            <p><strong>Danh mục:</strong> ${product.category}</p>
                            <p><strong>Giá:</strong> ${formatPrice(product.price)}</p>
                            <p><strong>Tồn kho:</strong> ${product.stock}</p>
                            <p><strong>Trạng thái:</strong> <span class="status ${product.status}">${getStatusText(product.status)}</span></p>
                        </div>
                    </div>
                    <div style="text-align: center;">
                        <button class="btn btn-primary" onclick="editProduct(${product.id})">
                            <i class="fas fa-edit"></i> Chỉnh sửa
                        </button>
                    </div>
                `;
                document.getElementById('productModal').style.display = 'block';
            }
        }

        function editProduct(id) {
            alert(`Chỉnh sửa sản phẩm ID: ${id}`);
            // Edit logic would be implemented here
        }

        function deleteProduct(id) {
            if (confirm('Bạn có chắc muốn xóa sản phẩm này?')) {
                // Delete logic would be implemented here
                alert('Sản phẩm đã được xóa!');
                renderProducts();
            }
        }

        function showAddProductModal() {
            document.getElementById('modalContent').innerHTML = `
                <h4>Thêm sản phẩm mới</h4>
                <p>Chức năng thêm sản phẩm mới sẽ được triển khai ở đây...</p>
                <div style="text-align: center; margin-top: 20px;">
                    <button class="btn btn-primary">
                        <i class="fas fa-save"></i> Lưu sản phẩm
                    </button>
                </div>
            `;
            document.getElementById('productModal').style.display = 'block';
        }

        function sortTable(field) {
            if (sortField === field) {
                sortDirection = sortDirection === 'asc' ? 'desc' : 'asc';
            } else {
                sortField = field;
                sortDirection = 'asc';
            }
            
            products.sort((a, b) => {
                let aValue = a[field];
                let bValue = b[field];
                
                if (typeof aValue === 'string') {
                    aValue = aValue.toLowerCase();
                    bValue = bValue.toLowerCase();
                }
                
                if (sortDirection === 'asc') {
                    return aValue > bValue ? 1 : -1;
                } else {
                    return aValue < bValue ? 1 : -1;
                }
            });
            
            renderProducts();
        }
    </script>
</body>
</html>