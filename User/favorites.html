<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sản phẩm yêu thích - Nhà Thuốc Online</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary-color: #2c8c4d;
            --primary-dark: #1e6e3d;
            --secondary-color: #3498db;
            --accent-color: #e74c3c;
            --light-color: #f8f9fa;
            --dark-color: #2c3e50;
            --text-color: #333;
            --text-light: #666;
            --shadow: 0 5px 15px rgba(0,0,0,0.1);
            --transition: all 0.3s ease;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background-color: var(--light-color);
            color: var(--text-color);
            line-height: 1.6;
        }

        /* Header */
        header {
            background: linear-gradient(135deg, var(--primary-color), var(--primary-dark));
            color: white;
            padding: 15px 0;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            position: sticky;
            top: 0;
            z-index: 1000;
        }

        .header-container, .nav-container, .main-container, .footer-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }

        .header-container {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            font-size: 28px;
            font-weight: bold;
            display: flex;
            align-items: center;
            gap: 10px;
            text-decoration: none;
            color: white;
        }

        .logo span {
            font-size: 32px;
        }

        .user-actions {
            display: flex;
            gap: 15px;
            align-items: center;
        }

        .user-actions a {
            color: white;
            text-decoration: none;
            display: flex;
            align-items: center;
            gap: 5px;
            padding: 8px 15px;
            border-radius: 4px;
            transition: var(--transition);
            position: relative;
        }

        .user-actions a:hover {
            background: rgba(255,255,255,0.1);
        }

        .cart-count {
            position: absolute;
            top: -5px;
            right: 0;
            background: var(--accent-color);
            color: white;
            border-radius: 50%;
            width: 18px;
            height: 18px;
            font-size: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        /* Navigation */
        nav {
            background-color: var(--primary-dark);
        }

        .nav-menu {
            display: flex;
            list-style: none;
        }

        .nav-menu li {
            position: relative;
        }

        .nav-menu a {
            display: block;
            color: white;
            text-decoration: none;
            padding: 15px 20px;
            transition: var(--transition);
            font-weight: 500;
        }

        .nav-menu a:hover {
            background-color: rgba(255,255,255,0.1);
        }

        /* Main Content */
        .main-container {
            margin: 30px auto;
            display: flex;
            gap: 30px;
        }

        /* Sidebar */
        .sidebar {
            width: 280px;
            background: white;
            border-radius: 10px;
            box-shadow: var(--shadow);
            padding: 25px;
            height: fit-content;
            position: sticky;
            top: 20px;
        }

        .user-profile {
            text-align: center;
            padding: 20px 0;
            border-bottom: 1px solid #eee;
            margin-bottom: 20px;
        }

        .user-avatar {
            width: 100px;
            height: 100px;
            border-radius: 50%;
            background: var(--primary-color);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 40px;
            margin: 0 auto 15px;
        }

        .user-name {
            font-size: 1.3em;
            font-weight: bold;
            color: var(--text-color);
            margin-bottom: 5px;
        }

        .user-email {
            color: var(--text-light);
            font-size: 0.9em;
        }

        .sidebar-menu {
            list-style: none;
        }

        .sidebar-menu li {
            margin-bottom: 5px;
        }

        .sidebar-menu a {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 12px 15px;
            color: var(--text-color);
            text-decoration: none;
            border-radius: 5px;
            transition: var(--transition);
        }

        .sidebar-menu a:hover, .sidebar-menu a.active {
            background: #e8f5e8;
            color: var(--primary-color);
        }

        /* Content */
        .content {
            flex: 1;
            background: white;
            border-radius: 10px;
            box-shadow: var(--shadow);
            padding: 30px;
        }

        .content-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            padding-bottom: 15px;
            border-bottom: 2px solid #e8f5e8;
        }

        .content-header h1 {
            color: var(--primary-color);
            font-size: 1.8em;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .favorites-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 20px;
            text-align: center;
            border-left: 4px solid var(--primary-color);
        }

        .stat-number {
            font-size: 2em;
            font-weight: bold;
            color: var(--primary-color);
            margin-bottom: 5px;
        }

        .stat-label {
            color: var(--text-light);
            font-size: 0.9em;
        }

        .filters-bar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 8px;
        }

        .sort-options {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .sort-select {
            padding: 8px 12px;
            border: 1px solid #ddd;
            border-radius: 4px;
            background: white;
            font-size: 14px;
        }

        .view-options {
            display: flex;
            gap: 10px;
        }

        .view-btn {
            padding: 8px 12px;
            border: 1px solid #ddd;
            background: white;
            border-radius: 4px;
            cursor: pointer;
            transition: var(--transition);
        }

        .view-btn.active {
            background: var(--primary-color);
            color: white;
            border-color: var(--primary-color);
        }

        /* Grid View */
        .favorites-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 25px;
            margin-bottom: 30px;
        }

        /* List View */
        .favorites-grid.list-view {
            grid-template-columns: 1fr;
        }

        .favorites-grid.list-view .product-card {
            display: flex;
            text-align: left;
            gap: 20px;
            padding: 20px;
        }

        .favorites-grid.list-view .product-image {
            width: 120px;
            height: 120px;
            flex-shrink: 0;
            margin-bottom: 0;
        }

        .favorites-grid.list-view .product-info {
            flex: 1;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
        }

        .favorites-grid.list-view .product-actions {
            align-self: flex-end;
        }

        .product-card {
            background: #fafafa;
            border-radius: 12px;
            box-shadow: var(--shadow);
            padding: 20px;
            text-align: center;
            transition: var(--transition);
            position: relative;
            cursor: pointer;
        }

        .product-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.15);
        }

        .product-badge {
            position: absolute;
            top: 15px;
            left: 15px;
            background: var(--accent-color);
            color: white;
            padding: 5px 10px;
            border-radius: 4px;
            font-size: 0.8em;
            font-weight: bold;
            z-index: 1;
        }

        .product-badge.new {
            background: #3498db;
        }

        .product-badge.sale {
            background: #e74c3c;
        }

        .product-image {
            width: 100%;
            height: 180px;
            object-fit: contain;
            border-radius: 8px;
            margin-bottom: 15px;
            background: #f9f9f9;
            padding: 10px;
        }

        .product-card h3 {
            font-size: 1.1em;
            margin-bottom: 10px;
            color: var(--text-color);
            height: 40px;
            overflow: hidden;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            line-clamp: 2;
            -webkit-box-orient: vertical;
        }

        .product-price {
            color: var(--accent-color);
            font-weight: bold;
            font-size: 1.3em;
            margin-bottom: 15px;
        }

        .product-original-price {
            color: var(--text-light);
            text-decoration: line-through;
            font-size: 0.9em;
            margin-right: 10px;
        }

        .product-rating {
            display: flex;
            justify-content: center;
            gap: 2px;
            margin-bottom: 10px;
        }

        .rating-star {
            color: #ddd;
        }

        .rating-star.filled {
            color: #ffc107;
        }

        .product-actions {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
        }

        .action-btn {
            flex: 1;
            padding: 10px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            transition: var(--transition);
            font-size: 0.9em;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 5px;
        }

        .add-to-cart {
            background: var(--primary-color);
            color: white;
        }

        .add-to-cart:hover {
            background: var(--primary-dark);
        }

        .remove-favorite {
            background: #f8f9fa;
            color: var(--text-light);
            border: 1px solid #ddd;
        }

        .remove-favorite:hover {
            background: #f8d7da;
            color: var(--accent-color);
            border-color: var(--accent-color);
        }

        .no-favorites {
            text-align: center;
            padding: 60px 20px;
            color: var(--text-light);
            grid-column: 1 / -1;
        }

        .no-favorites .icon {
            font-size: 80px;
            margin-bottom: 20px;
            color: #ddd;
        }

        .browse-products {
            display: inline-block;
            margin-top: 20px;
            padding: 12px 25px;
            background: var(--primary-color);
            color: white;
            text-decoration: none;
            border-radius: 6px;
            transition: var(--transition);
        }

        .browse-products:hover {
            background: var(--primary-dark);
        }

        .pagination {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-top: 30px;
        }

        .page-btn {
            padding: 10px 15px;
            border: 1px solid #ddd;
            background: white;
            border-radius: 6px;
            cursor: pointer;
            transition: var(--transition);
        }

        .page-btn.active, .page-btn:hover {
            background: var(--primary-color);
            color: white;
            border-color: var(--primary-color);
        }

        footer {
            background: var(--dark-color);
            color: white;
            padding: 60px 0 20px;
            margin-top: 50px;
        }

        .footer-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 40px;
            margin-bottom: 40px;
        }

        .footer-section h3 {
            color: var(--primary-color);
            margin-bottom: 20px;
            font-size: 1.3em;
        }

        .footer-section p {
            color: #ddd;
            line-height: 1.6;
            margin-bottom: 15px;
        }

        .footer-section ul {
            list-style: none;
        }

        .footer-section ul li {
            margin-bottom: 10px;
        }

        .footer-section a {
            color: #ddd;
            text-decoration: none;
            transition: var(--transition);
        }

        .footer-section a:hover {
            color: var(--primary-color);
            padding-left: 5px;
        }

        .contact-info li {
            display: flex;
            align-items: flex-start;
            gap: 10px;
            margin-bottom: 15px;
            color: #ddd;
        }

        .contact-info i {
            margin-top: 3px;
            color: var(--primary-color);
        }

        .social-links {
            display: flex;
            gap: 15px;
            margin-top: 20px;
        }

        .social-links a {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 40px;
            height: 40px;
            background: rgba(255,255,255,0.1);
            border-radius: 50%;
            transition: var(--transition);
        }

        .social-links a:hover {
            background: var(--primary-color);
            transform: translateY(-3px);
            padding-left: 0;
        }

        .copyright {
            text-align: center;
            padding-top: 20px;
            border-top: 1px solid rgba(255,255,255,0.1);
            color: #bbb;
            font-size: 0.9em;
        }

        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 15px 25px;
            background: var(--primary-color);
            color: white;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            z-index: 10000;
            transform: translateX(150%);
            transition: transform 0.3s ease;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .notification.show {
            transform: translateX(0);
        }

        .notification.error {
            background: var(--accent-color);
        }

        @media (max-width: 768px) {
            .main-container {
                flex-direction: column;
            }
            
            .sidebar {
                width: 100%;
                position: static;
            }
            
            .content-header {
                flex-direction: column;
                gap: 15px;
                align-items: flex-start;
            }
            
            .filters-bar {
                flex-direction: column;
                gap: 15px;
                align-items: flex-start;
            }
            
            .favorites-grid {
                grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            }
            
            .favorites-grid.list-view .product-card {
                flex-direction: column;
                text-align: center;
            }
            
            .favorites-grid.list-view .product-actions {
                align-self: center;
            }
            
            .product-actions {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header>
        <div class="header-container">
            <a href="index.html" class="logo">
                <span>🏥</span>
                NHÀ THUỐC ONLINE
            </a>
            
            <div class="user-actions">
                <a href="customer-info.html"><i class="fas fa-user"></i> Nguyễn Văn Minh</a>
                <a href="order-history.html"><i class="fas fa-box"></i> Đơn hàng</a>
                <a href="cart.html"><i class="fas fa-shopping-cart"></i> Giỏ hàng <span class="cart-count">0</span></a>
                <a href="#" id="logout-btn"><i class="fas fa-sign-out-alt"></i> Đăng xuất</a>
            </div>
        </div>
    </header>

    <!-- Navigation -->
    <nav>
        <div class="nav-container">
            <ul class="nav-menu">
                <li><a href="index.html"><i class="fas fa-home"></i> Trang chủ</a></li>
                <li><a href="functional-foods.html"><i class="fas fa-pills"></i> TPCN</a></li>
                <li><a href="medical-supplies.html"><i class="fas fa-stethoscope"></i> Vật phẩm Y tế</a></li>
                <li><a href="prescription-medicine.html"><i class="fas fa-file-prescription"></i> Thuốc kê đơn</a></li>
                <li><a href="over-the-counter-medication.html"><i class="fas fa-capsules"></i> Thuốc không kê đơn</a></li>
                <li><a href="health-consultation.html"><i class="fas fa-heartbeat"></i> Tư vấn sức khỏe</a></li>
            </ul>
        </div>
    </nav>

    <!-- Main Content -->
    <div class="main-container">
        <!-- Sidebar -->
        <div class="sidebar">
            <div class="user-profile">
                <div class="user-avatar"><i class="fas fa-user"></i></div>
                <div class="user-name">Nguyễn Văn Minh</div>
                <div class="user-email">minh.nguyen@email.com</div>
            </div>
            
            <ul class="sidebar-menu">
                <li><a href="customer-info.html"><i class="fas fa-user-circle"></i> Thông tin cá nhân</a></li>
                <li><a href="order-history.html"><i class="fas fa-box"></i> Lịch sử đơn hàng</a></li>
                <li><a href="favorites.html" class="active"><i class="fas fa-heart"></i> Sản phẩm yêu thích</a></li>
                <li><a href="change-password.html"><i class="fas fa-key"></i> Đổi mật khẩu</a></li>
                <li><a href="addresses.html"><i class="fas fa-map-marker-alt"></i> Địa chỉ giao hàng</a></li>
            </ul>
        </div>

        <!-- Content -->
        <div class="content">
            <div class="content-header">
                <h1><i class="fas fa-heart"></i> Sản phẩm yêu thích</h1>
            </div>

            <div class="favorites-stats">
                <div class="stat-card">
                    <div class="stat-number" id="totalFavorites">0</div>
                    <div class="stat-label">Tổng sản phẩm</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="availableProducts">0</div>
                    <div class="stat-label">Còn hàng</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="discountProducts">0</div>
                    <div class="stat-label">Đang giảm giá</div>
                </div>
            </div>

            <div class="filters-bar">
                <div class="sort-options">
                    <span>Sắp xếp theo:</span>
                    <select class="sort-select" id="sortSelect">
                        <option value="date">Mới nhất</option>
                        <option value="price-asc">Giá tăng dần</option>
                        <option value="price-desc">Giá giảm dần</option>
                        <option value="name">Tên A-Z</option>
                        <option value="rating">Đánh giá cao nhất</option>
                    </select>
                </div>
                <div class="view-options">
                    <button class="view-btn active" data-view="grid"><i class="fas fa-th"></i></button>
                    <button class="view-btn" data-view="list"><i class="fas fa-list"></i></button>
                </div>
            </div>

            <div class="favorites-grid" id="favoritesGrid">
                <!-- Favorites will be loaded here -->
            </div>

            <div class="pagination" id="pagination">
                <!-- Pagination will be generated here -->
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer>
        <div class="footer-container">
            <div class="footer-section">
                <h3>Về chúng tôi</h3>
                <p>Nhà Thuốc Online với hơn 10 năm kinh nghiệm trong lĩnh vực chăm sóc sức khỏe, cam kết mang đến những sản phẩm chất lượng nhất với giá cả hợp lý nhất cho khách hàng.</p>
                <div class="social-links">
                    <a href="https://www.facebook.com/thailionel2504" target="_blank" rel="noopener"><i class="fab fa-facebook-f"></i></a>
                    <a href="https://x.com/Trngquc76951Thi?s=09" target="_blank" rel="noopener"><i class="fab fa-twitter"></i></a>
                    <a href="https://www.instagram.com/thailionel2504?igsh=aWhpaTB6NmozNHc5" target="_blank" rel="noopener"><i class="fab fa-instagram"></i></a>
                    <a href="https://www.youtube.com/?app=desktop&hl=vi" target="_blank" rel="noopener"><i class="fab fa-youtube"></i></a>
                </div>
            </div>
            <div class="footer-section">
                <h3>Liên kết nhanh</h3>
                <ul>
                    <li><a href="index.html">Trang chủ</a></li>
                    <li><a href="functional-foods.html">Thực phẩm chức năng</a></li>
                    <li><a href="medical-supplies.html">Vật phẩm y tế</a></li>
                    <li><a href="prescription-medicine.html">Thuốc kê đơn</a></li>
                    <li><a href="over-the-counter-medication.html">Thuốc không kê đơn</a></li>
                    <li><a href="health-consultation.html">Tư vấn sức khỏe</a></li>
                </ul>
            </div>
            <div class="footer-section">
                <h3>Chính sách</h3>
                <ul>
                    <li><a href="privacy-policy.html">Chính sách bảo mật</a></li>
                    <li><a href="return-policy.html">Chính sách đổi trả</a></li>
                    <li><a href="shipping-policy.html">Chính sách vận chuyển</a></li>
                    <li><a href="payment-policy.html">Chính sách thanh toán</a></li>
                    <li><a href="terms.html">Điều khoản sử dụng</a></li>
                </ul>
            </div>
            <div class="footer-section">
                <h3>Liên hệ</h3>
                <ul class="contact-info">
                    <li><i class="fas fa-map-marker-alt"></i> 123 Đường ABC, Quận XYZ, TP.HCM</li>
                    <li><i class="fas fa-phone"></i> (028) 1234 5678</li>
                    <li><i class="fas fa-envelope"></i> info@nhathuoconline.com</li>
                    <li><i class="fas fa-clock"></i> Mở cửa: 8:00 - 22:00 hàng ngày</li>
                </ul>
            </div>
        </div>
        <div class="copyright">
            &copy; 2023 Nhà Thuốc Online. Tất cả các quyền được bảo lưu. | Phát triển bởi Team Dev
        </div>
    </footer>

    <!-- Notification -->
    <div class="notification" id="notification">
        <i class="fas fa-check-circle"></i>
        <span id="notification-text">Thông báo</span>
    </div>

    <script>
        // Khởi tạo giỏ hàng nếu chưa có
        if (!localStorage.getItem('cart')) {
            localStorage.setItem('cart', JSON.stringify([]));
        }

        // Khởi tạo danh sách yêu thích nếu chưa có
        if (!localStorage.getItem('wishlist')) {
            localStorage.setItem('wishlist', JSON.stringify([]));
        }

        // Dữ liệu mẫu sản phẩm
        const sampleProducts = [
            { 
                id: 1, 
                name: "Vitamin C 1000mg Nature Made", 
                price: 150000, 
                originalPrice: 180000,
                category: "functional-foods", 
                rating: 5, 
                image: "https://www.naturesaid.co.uk/images/vitamin-c-1000mg-time-release-p245-378_image.jpg", 
                badge: "sale", 
                inStock: true 
            },
            { 
                id: 2, 
                name: "Omega-3 1000mg Kirkland", 
                price: 250000, 
                category: "functional-foods", 
                rating: 4, 
                image: "https://primenutrition.ec/1317-large_default/omega-3-1000mg-60-capsulas.jpg", 
                badge: "new", 
                inStock: true 
            },
            { 
                id: 4, 
                name: "Collagen 3000mg", 
                price: 350000, 
                category: "functional-foods", 
                rating: 5, 
                image: "https://www.corposflex.com/image/cache/data/Corposflex/essence-collagen-3000mg-90-tablets-600x600.jpg", 
                badge: "sale", 
                inStock: true 
            },
            { 
                id: 10, 
                name: "Nhiệt kế điện tử Omron", 
                price: 280000, 
                category: "medical-supplies", 
                rating: 5, 
                image: "https://www.ykhoakimyen.com/upload/images/21-nhiet-ke-dien-tu-omron-mc-246.jpg", 
                badge: "new", 
                inStock: true 
            }
        ];

        // Cập nhật số lượng giỏ hàng
        function updateCartCount() {
            const cart = JSON.parse(localStorage.getItem('cart')) || [];
            const totalItems = cart.reduce((total, item) => total + item.quantity, 0);
            document.querySelectorAll('.cart-count').forEach(element => {
                element.textContent = totalItems;
            });
        }

        // Hiển thị thông báo
        function showNotification(message, type = 'success') {
            const notification = document.getElementById('notification');
            const notificationText = document.getElementById('notification-text');
            
            notificationText.textContent = message;
            notification.className = `notification ${type}`;
            notification.classList.add('show');
            
            setTimeout(() => {
                notification.classList.remove('show');
            }, 3000);
        }

        // Tạo HTML rating stars
        function generateRatingStars(rating) {
            let stars = '';
            const fullStars = Math.floor(rating);
            const hasHalfStar = rating % 1 !== 0;
            
            for (let i = 0; i < fullStars; i++) {
                stars += '<i class="fas fa-star rating-star filled"></i>';
            }
            
            if (hasHalfStar) {
                stars += '<i class="fas fa-star-half-alt rating-star filled"></i>';
            }
            
            const emptyStars = 5 - Math.ceil(rating);
            for (let i = 0; i < emptyStars; i++) {
                stars += '<i class="far fa-star rating-star"></i>';
            }
            
            return stars;
        }

        // Format price
        function formatPrice(price) {
            return new Intl.NumberFormat('vi-VN', {
                style: 'currency',
                currency: 'VND'
            }).format(price);
        }

        // Hiển thị sản phẩm yêu thích
        function displayFavorites(page = 1, productsPerPage = 8) {
            const wishlist = JSON.parse(localStorage.getItem('wishlist')) || [];
            const favoritesGrid = document.getElementById('favoritesGrid');
            const pagination = document.getElementById('pagination');
            
            // Nếu danh sách yêu thích trống, thêm một số sản phẩm mẫu
            if (wishlist.length === 0) {
                localStorage.setItem('wishlist', JSON.stringify(sampleProducts));
            }
            
            const favorites = JSON.parse(localStorage.getItem('wishlist')) || [];
            
            // Cập nhật thống kê
            updateFavoritesStats(favorites);
            
            // Tính toán phân trang
            const totalPages = Math.ceil(favorites.length / productsPerPage);
            const startIndex = (page - 1) * productsPerPage;
            const endIndex = startIndex + productsPerPage;
            const paginatedFavorites = favorites.slice(startIndex, endIndex);
            
            // Hiển thị sản phẩm
            if (paginatedFavorites.length === 0) {
                favoritesGrid.innerHTML = `
                    <div class="no-favorites">
                        <div class="icon"><i class="fas fa-heart"></i></div>
                        <h3>Chưa có sản phẩm yêu thích</h3>
                        <p>Hãy thêm sản phẩm vào danh sách yêu thích để dễ dàng theo dõi</p>
                        <a href="functional-foods.html" class="browse-products">
                            <i class="fas fa-shopping-bag"></i> Khám phá sản phẩm
                        </a>
                    </div>
                `;
                pagination.innerHTML = '';
            } else {
                favoritesGrid.innerHTML = paginatedFavorites.map(product => `
                    <div class="product-card" data-id="${product.id}">
                        ${product.badge ? `<div class="product-badge ${product.badge}">${product.badge === 'new' ? 'Mới' : product.badge === 'sale' ? 'Giảm giá' : ''}</div>` : ''}
                        <img src="${product.image}" alt="${product.name}" class="product-image" onerror="this.src='https://via.placeholder.com/200x180?text=No+Image'">
                        <div class="product-info">
                            <h3>${product.name}</h3>
                            <div class="product-rating">
                                ${generateRatingStars(product.rating)}
                            </div>
                            <div class="product-price">
                                ${product.originalPrice ? `<span class="product-original-price">${formatPrice(product.originalPrice)}</span>` : ''}
                                ${formatPrice(product.price)}
                            </div>
                            <div class="product-actions">
                                <button class="action-btn add-to-cart" data-id="${product.id}">
                                    <i class="fas fa-cart-plus"></i> Thêm giỏ hàng
                                </button>
                                <button class="action-btn remove-favorite" data-id="${product.id}">
                                    <i class="fas fa-trash"></i> Xóa
                                </button>
                            </div>
                        </div>
                    </div>
                `).join('');
                
                // Hiển thị phân trang
                displayPagination(totalPages, page);
                
                // Thêm sự kiện cho các nút
                document.querySelectorAll('.add-to-cart').forEach(button => {
                    button.addEventListener('click', function(e) {
                        e.stopPropagation();
                        const productId = this.getAttribute('data-id');
                        addToCartFromFavorites(productId);
                    });
                });
                
                document.querySelectorAll('.remove-favorite').forEach(button => {
                    button.addEventListener('click', function(e) {
                        e.stopPropagation();
                        const productId = this.getAttribute('data-id');
                        removeFromFavorites(productId);
                    });
                });
                
                // Thêm sự kiện click cho sản phẩm
                document.querySelectorAll('.product-card').forEach(card => {
                    card.addEventListener('click', function() {
                        const productId = this.getAttribute('data-id');
                        window.location.href = `product-details.html?id=${productId}`;
                    });
                });
            }
        }

        // Cập nhật thống kê
        function updateFavoritesStats(favorites) {
            const totalFavorites = favorites.length;
            const availableProducts = favorites.filter(product => product.inStock).length;
            const discountProducts = favorites.filter(product => product.badge && product.badge === 'sale').length;
            
            document.getElementById('totalFavorites').textContent = totalFavorites;
            document.getElementById('availableProducts').textContent = availableProducts;
            document.getElementById('discountProducts').textContent = discountProducts;
        }

        // Hiển thị phân trang
        function displayPagination(totalPages, currentPage) {
            const pagination = document.getElementById('pagination');
            
            if (totalPages <= 1) {
                pagination.innerHTML = '';
                return;
            }
            
            let paginationHTML = '';
            
            // Nút Previous
            if (currentPage > 1) {
                paginationHTML += `<button class="page-btn" data-page="${currentPage - 1}"><i class="fas fa-chevron-left"></i></button>`;
            }
            
            // Các nút trang
            for (let i = 1; i <= totalPages; i++) {
                if (i === currentPage) {
                    paginationHTML += `<button class="page-btn active" data-page="${i}">${i}</button>`;
                } else {
                    paginationHTML += `<button class="page-btn" data-page="${i}">${i}</button>`;
                }
            }
            
            // Nút Next
            if (currentPage < totalPages) {
                paginationHTML += `<button class="page-btn" data-page="${currentPage + 1}"><i class="fas fa-chevron-right"></i></button>`;
            }
            
            pagination.innerHTML = paginationHTML;
            
            // Thêm sự kiện cho nút phân trang
            document.querySelectorAll('.page-btn').forEach(button => {
                button.addEventListener('click', function() {
                    const page = parseInt(this.getAttribute('data-page'));
                    displayFavorites(page);
                });
            });
        }

        // Thêm vào giỏ hàng từ danh sách yêu thích
        function addToCartFromFavorites(productId) {
            const wishlist = JSON.parse(localStorage.getItem('wishlist')) || [];
            const product = wishlist.find(item => item.id == productId);
            
            if (product) {
                const cart = JSON.parse(localStorage.getItem('cart')) || [];
                const existingItem = cart.find(item => item.id == productId);
                
                if (existingItem) {
                    existingItem.quantity += 1;
                } else {
                    cart.push({
                        ...product,
                        quantity: 1
                    });
                }
                
                localStorage.setItem('cart', JSON.stringify(cart));
                updateCartCount();
                showNotification(`Đã thêm ${product.name} vào giỏ hàng!`);
            }
        }

        // Xóa khỏi danh sách yêu thích
        function removeFromFavorites(productId) {
            if (confirm('Bạn có chắc muốn xóa sản phẩm này khỏi danh sách yêu thích?')) {
                const wishlist = JSON.parse(localStorage.getItem('wishlist')) || [];
                const updatedWishlist = wishlist.filter(item => item.id != productId);
                
                localStorage.setItem('wishlist', JSON.stringify(updatedWishlist));
                displayFavorites();
                showNotification('Đã xóa sản phẩm khỏi danh sách yêu thích!');
            }
        }

        // Xử lý sắp xếp
        document.getElementById('sortSelect').addEventListener('change', function() {
            const sortValue = this.value;
            const wishlist = JSON.parse(localStorage.getItem('wishlist')) || [];
            let sortedWishlist = [...wishlist];
            
            switch (sortValue) {
                case 'price-asc':
                    sortedWishlist.sort((a, b) => a.price - b.price);
                    break;
                case 'price-desc':
                    sortedWishlist.sort((a, b) => b.price - a.price);
                    break;
                case 'name':
                    sortedWishlist.sort((a, b) => a.name.localeCompare(b.name));
                    break;
                case 'rating':
                    sortedWishlist.sort((a, b) => b.rating - a.rating);
                    break;
                case 'date':
                default:
                    // Giữ nguyên thứ tự (mới nhất đầu tiên)
                    break;
            }
            
            localStorage.setItem('wishlist', JSON.stringify(sortedWishlist));
            displayFavorites();
        });

        // Xử lý view options
        document.querySelectorAll('.view-btn').forEach(btn => {
            btn.addEventListener('click', function() {
                document.querySelectorAll('.view-btn').forEach(b => b.classList.remove('active'));
                this.classList.add('active');
                
                const viewType = this.getAttribute('data-view');
                const favoritesGrid = document.getElementById('favoritesGrid');
                
                if (viewType === 'list') {
                    favoritesGrid.classList.add('list-view');
                } else {
                    favoritesGrid.classList.remove('list-view');
                }
            });
        });

        // Xử lý đăng xuất
        document.getElementById('logout-btn').addEventListener('click', function(e) {
            e.preventDefault();
            if (confirm('Bạn có chắc muốn đăng xuất?')) {
                localStorage.removeItem('currentUser');
                window.location.href = 'index.html';
            }
        });

        // Khởi tạo
        document.addEventListener('DOMContentLoaded', function() {
            updateCartCount();
            displayFavorites();
        });
    </script>
</body>
</html>